language: java
install: true

os: linux
dist: trusty
jdk: oraclejdk8

env:
  - PLATFORM_VERSION=192
#  - PLATFORM_VERSION=193

# https://guides.gradle.org/executing-gradle-builds-on-travisci/
script:
  - ./gradlew buildPlugin -PplatformVersion=$PLATFORM_VERSION

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

deploy:
  provider: releases
  api_key:
    secure: lDx0KEZsmJ8sgiZQN6wKsMcnOM42uepAeDIFXJhcyBbdYIPw39ejOlhVcDsHkRIf0XDwiljXuIYHo6MvnWC7USJKuLhRoZHA/dKij++q5FVkre2aChB7JkTpnRH+8vDfLDP5sjGeyBCFCK5uzXAGjAbfy5mAzMuWzGpR0FxWQUZLJf/Nqh+NwegYNnhQ5cUVK57MTgjoYm0/A21mZfbLt2/UqMNCh1A6vwe+LzVCmrApNE1VMJo2euQtx8s6SUy44iTE/L6O5AiUjsZfd1579zc0B1qMqxKwt37xdtAFwVYxcgcKZpjUqz+eTXTF+LlI96/T4Q58AFhTkknshqgMfi03SzLKruDfaJbcXkbKc2qbQxSTUQ3DfUyjwibqfI08t6dZeWVYyp3eBtYBK0ZpaL9FI0HkekvatQiev/qwpFd/1B3Y7RXpzWAJW/K0HntcCyIRc0j9zGcQGa3ms96CG7h59IhhVGaxO+cn3D/Rzl8bt2k+jxqgF1F+obOC/FXm/z97NUYz6XTjMh8YgRZJJ7chFYF4itRm+g/V47rdcVZiAkHmvjCaOfCbV8+SaG9UjyFFFUl0bkTo/YKhYNPbJxNIg2LmHk9tt991NDvy2IHCSggXT5x9/f4d+qMgzqmVsnAc+9zGZu5NUYEnbnk7NX9WRJKHJgeNoI4WLGlo1cE=
  draft: true
  file_glob: true
  file: build/libs/*.jar
  skip_cleanup: true
  on:
    branch: travis