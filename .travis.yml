language: java
install: true

os: linux
dist: trusty
jdk: oraclejdk8

env:
  - PLATFORM_VERSION=192
#  - PLATFORM_VERSION=193

# https://guides.gradle.org/executing-gradle-builds-on-travisci/
script:
  - ./gradlew buildPlugin -PplatformVersion=$PLATFORM_VERSION

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

deploy:
  provider: releases
  api_key:
    secure: X7Mr0skcjsggfppdGt+bxRGXE2yF2hWAiMsrcGoL0LS43mLBke5SnSzwS5dY/6Dgq4GOsyurDg4/zQtRnqO0qzMkKoN9enUeU1TSxn9RryCLE9YfpZTrJF3kMUkJ9rjyu64P23+E2iaKjMANu85F24+ePURLHqgqHeEStVWARZkVWkz4knvkSRImBCZzKm+AFM/kbXChLPN+ILKT7eDaa5BbwgWZvQE253+KJ4uwbBxfCKnCHeoFOD/KKavvPMkFhqrmRkA8O+ernIR4yLFRep0ONtpvpaFqTwyhQQWLLm0pPv3QP/4Ofjbu4i6kEX1aNOak6hsl0+tX2klaAE4RsxziwKnpY0Z6da0sAyJ6+Qod0HJgzGJYZGGDVltsAJw85Kp902KHp65jBv7PQ4KzYvNQfWAX9Rd6JSXfA4wXArgqBAoOLMVANAJ6i6r4g/JB2AGKBHCVSp1Px1o8VNIkHhOXBkMJnvJX1PQ3o2o6l76k32UFBEvqV2B9NqHiu6WHAV6F/Nzar2rsRI8PlUXt/PGx4KAFPgcdaO5FXr5dB6umN+5GWzo+Nr/hsmedPR6c1eqGG8/mClJmWyNJrjgciS2/ltScy52MOhmPajt5Wd9YCLTGfWQFCc6WdwgKlSkXpLo1ly2biwB3dk8alCDzFtwo/4/FjYqRG2nV1ParCb0=
  draft: true
  file_glob: true
  file: build/libs/*.jar
  skip_cleanup: true
  on:
    branch: travis